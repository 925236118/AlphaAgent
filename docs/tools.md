# Godot AI Agent 工具文档

本文档介绍了可供 AI 模型使用的 Function Call 工具列表。这些工具允许 AI 助手与 Godot 编辑器进行交互，实现项目信息查询、文件操作、类文档查询等功能。

---

## 工具列表汇总

| # | 工具名称 | 分类 | 简要描述 | 参数数量 |
|---|---------|------|---------|---------|
| 1 | `get_project_info` | 查询 | 获取 Godot 引擎、系统和项目配置信息 | 0 |
| 2 | `get_editor_info` | 查询 | 获取编辑器当前打开的场景和脚本状态 | 0 |
| 3 | `get_project_file_list` | 查询 | 获取项目中所有文件及其 UID 列表 | 0 |
| 4 | `read_file` | 文件操作 | 读取指定文件的内容 | 1 |
| 5 | `write_file` | 文件操作 | 写入或覆盖文件内容 | 2 |
| 6 | `create_folder` | 文件操作 | 创建文件夹 | 1 |
| 7 | `get_class_doc` | 查询 | 获取 Godot 原生类的文档信息 | 1~4 |

---

## 详细文档

### 1. get_project_info

**功能说明**：获取当前的 Godot 引擎信息和项目配置信息

**参数**

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| - | - | - | 无需参数 |

**返回值**

| 字段 | 子字段 | 描述 |
|------|--------|------|
| `engine` | `engine_version` | Godot 版本信息 |
| `system` | `cpu_info` | CPU 型号 |
| | `architecture_name` | CPU 架构 |
| | `memory_info` | 内存信息 |
| | `model_name` | 设备型号 |
| | `platform_name` | 平台名称 |
| | `system_version` | 系统版本 |
| | `video_adapter_name` | 显卡名称 |
| | `video_adapter_driver` | 显卡驱动信息 |
| | `rendering_method` | 渲染方法 |
| | `system_time` | 当前系统时间 |
| `project` | `project_name` | 项目名称 |
| | `project_version` | 项目版本 |
| | `project_description` | 项目描述 |
| | `main_scene` | 主场景路径 |
| | `window` | 窗口配置对象（分辨率、模式等） |
| | `physics` | 物理设置对象（帧率、插值） |
| | `rendering` | 渲染设置对象 |

**使用场景**
- 了解当前开发环境和硬件配置
- 获取项目基本信息和配置
- 调试系统兼容性问题

---

### 2. get_editor_info

**功能说明**：获取当前编辑器的状态信息，包括打开的场景和脚本

**参数**

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| - | - | - | 无需参数 |

**返回值**

| 字段 | 描述 |
|------|------|
| `editor.opened_scenes` | 当前打开的所有场景列表（数组） |
| `editor.current_edited_scene` | 当前正在编辑的场景文件路径 |
| `editor.current_scene_root_node` | 当前场景的根节点对象 |
| `editor.current_opend_script` | 当前选中的脚本文件路径 |
| `editor.opend_scripts` | 所有已打开的脚本文件列表（数组） |

**使用场景**
- 了解当前工作上下文
- 确定需要修改的文件
- 获取场景结构信息
- 自动化操作当前编辑的文件

---

### 3. get_project_file_list

**功能说明**：获取当前项目中所有文件及其 UID 的列表

**参数**

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| - | - | - | 无需参数 |

**返回值**

| 字段 | 描述 |
|------|------|
| `list` | 文件信息数组 |
| `list[].path` | 文件路径 |
| `list[].uid` | 文件的唯一标识符（UID） |

**过滤规则**

| 类型 | 说明 |
|------|------|
| 忽略目录 | `.godot`、`addons` |
| 忽略文件 | `*.uid` |

**使用场景**
- 浏览项目结构
- 查找特定文件
- 批量操作文件前的准备
- 获取文件的 UID 用于引用

---

### 4. read_file

**功能说明**：读取指定文件的内容

**参数**

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| `path` | string | ✅ | 文件路径，必须是以 `res://` 开头的绝对路径 |

**返回值**

| 字段 | 描述 |
|------|------|
| `file_path` | 文件路径 |
| `file_uid` | 文件 UID |
| `file_content` | 文件内容（字符串格式） |
| `open_error` | 错误代码（仅在读取失败时返回） |

**使用场景**
- 读取脚本内容进行分析
- 读取配置文件
- 检查文件内容
- 备份文件内容

**调用示例**

```json
{
  "path": "res://player.gd"
}
```

---

### 5. write_file

**功能说明**：写入或覆盖文件内容

**参数**

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| `path` | string | ✅ | 文件路径，必须是以 `res://` 开头的绝对路径 |
| `content` | string | ✅ | 需要写入的文件内容 |

**支持的文件格式**

| 扩展名 | 类型 |
|--------|------|
| `.tres` | 资源文件 |
| `.gd` | GDScript 脚本文件 |
| `.gdshader` | Godot 着色器 |
| `.tscn` | 场景文件 |
| `.txt`、`.md` | 文本文件 |
| `.csv` | CSV 文件 |

**返回值**

| 字段 | 描述 |
|------|------|
| `file_path` | 文件路径 |
| `file_uid` | 文件 UID |
| `file_content` | 写入后的文件内容 |
| `open_error` | 错误代码（仅在写入失败时返回） |

**特殊行为**

| 行为 | 说明 |
|------|------|
| 自动更新 | 写入后自动更新编辑器的文件系统 |
| 刷新编辑器 | 写入后刷新脚本编辑器 |
| 重载场景 | 如果是场景文件（.tscn），会自动重新加载 |

**使用场景**
- 创建新脚本
- 修改现有代码
- 生成配置文件
- 批量更新文件

**调用示例**

```json
{
  "path": "res://enemy.gd",
  "content": "extends CharacterBody2D\n\nfunc _ready():\n\tprint('Enemy spawned')\n"
}
```

---

### 6. create_folder

**功能说明**：在指定位置创建文件夹

**参数**

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| `path` | string | ✅ | 文件夹路径，必须是以 `res://` 开头的绝对路径 |

**返回值**

| 情况 | 返回值 |
|------|--------|
| 成功 | `{"success": "文件创建成功"}` |
| 已存在 | `{"error": "文件夹已存在，无需创建"}` |
| 失败 | `{"error": "文件夹创建失败，[错误原因]"}` |

**注意事项**

| 项目 | 说明 |
|------|------|
| 重复创建 | 如果文件夹已存在，不会报错，只会提示无需创建 |
| 自动扫描 | 创建后会自动扫描并更新编辑器文件系统 |
| 上级目录 | 上级目录必须存在，不支持递归创建 |

**使用场景**
- 组织项目结构
- 创建新模块目录
- 准备文件存储位置
- 按功能分类文件

**调用示例**

```json
{
  "path": "res://scripts/enemies"
}
```

---

### 7. get_class_doc

**功能说明**：获取 Godot 原生类的文档信息，包含类的属性、方法、参数、返回值、信号、枚举常量、父类、派生类等

**参数**

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| `class_name` | string | ✅ | 需要查询的类名（如 "Node"、"CharacterBody2D"） |
| `signals` | array | ❌ | 需要查询的信号名列表 |
| `properties` | array | ❌ | 需要查询的属性名列表 |
| `enums` | array | ❌ | 需要查询的枚举名列表 |

**返回值（完整查询）**

| 字段 | 描述 |
|------|------|
| `class_name` | 类名 |
| `api_type` | API 类型 |
| `properties` | 所有属性列表（数组） |
| `methods` | 所有方法列表（数组） |
| `enums` | 所有枚举列表（数组） |
| `parent_class` | 父类名称 |
| `inheriters_class` | 派生类列表（数组） |
| `signals` | 所有信号列表（数组） |
| `constants` | 所有整数常量列表（数组） |

**返回值（查询特定信号）**

| 字段 | 描述 |
|------|------|
| `class_name` | 类名 |
| `signals` | 指定信号的详细信息（数组） |

**返回值（查询特定属性）**

| 字段 | 描述 |
|------|------|
| `class_name` | 类名 |
| `properties[].default_value` | 默认值 |
| `properties[].setter` | 设置器方法名 |
| `properties[].getter` | 获取器方法名 |

**返回值（查询特定枚举）**

| 字段 | 描述 |
|------|------|
| `class_name` | 类名 |
| `enums[].enum` | 枚举名 |
| `enums[].values` | 枚举值列表（数组） |

**使用场景**
- 学习 Godot API
- 查找类的方法和属性
- 了解类的继承关系
- 查询枚举值和常量

**调用示例 1 - 完整查询**

```json
{
  "class_name": "Node"
}
```

**调用示例 2 - 查询特定枚举**

```json
{
  "class_name": "Node",
  "enums": ["ProcessMode", "ProcessThreadMessages"]
}
```

**调用示例 3 - 查询特定属性**

```json
{
  "class_name": "CharacterBody2D",
  "properties": ["velocity", "motion_mode"]
}
```

---

## 使用指南

### 路径格式规范

| 格式 | 示例 | 状态 |
|------|------|------|
| Godot 资源路径（正确） | `res://scripts/player.gd` | ✅ |
| 绝对路径（错误） | `E:\workspace\GameProject\godot-ai-agent\scripts\player.gd` | ❌ |
| 相对路径（错误） | `scripts/player.gd` | ❌ |

### 工作流程建议

| 步骤 | 操作 | 使用工具 |
|------|------|----------|
| 1 | 了解环境 | `get_project_info`、`get_editor_info` |
| 2 | 浏览文件 | `get_project_file_list` |
| 3 | 读取内容 | `read_file` |
| 4 | 修改文件 | `write_file` |
| 5 | 组织结构 | `create_folder` |
| 6 | 查询 API | `get_class_doc` |

### 最佳实践

| 实践 | 说明 |
|------|------|
| 读取前确认 | 在写入文件前，先使用 `read_file` 读取现有内容 |
| 路径检查 | 使用 `get_project_file_list` 确认文件路径是否正确 |
| API 查询 | 不确定 Godot 类的用法时，使用 `get_class_doc` 查询 |
| 结构规划 | 批量创建文件前，先用 `create_folder` 建立目录结构 |

---

## 错误处理

### 常见错误类型

| 错误类型 | 可能原因 | 解决方案 |
|----------|----------|----------|
| 文件不存在 | 路径错误或文件未创建 | 检查路径是否正确，是否使用了 `res://` 前缀 |
| 权限不足 | 文件被锁定或只读 | 确保文件不是只读状态 |
| 类不存在 | 类名拼写错误 | 检查类名拼写是否正确（区分大小写） |
| 上级目录不存在 | 创建文件夹时路径无效 | 先创建上级目录 |

### 错误字段

| 字段名 | 说明 |
|--------|------|
| `error` | 错误信息（字符串描述） |
| `open_error` | 文件操作错误代码（数值） |

---

## 版本信息

| 项目 | 值 |
|------|-----|
| 文档基于 | `addons/agent/tools/tools.gd` |
| 更新日期 | 2025-11-28 |
| 工具数量 | 7 |
